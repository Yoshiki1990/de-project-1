Привет!

1. data_quality.md - не стал перечислять ограничения по всем таблицам, если их в БД будут сотни, а мы строим витрину и использованием данных только нескольких, получится, что мы тратим время на рписание того, что нам не нужно
2. datamart_query.sql - логично, исправил, раньше обычно перечислял поля только тогда, когда вставлял данные только в часть полей
3. requirements.md - добавил из realisation.md, почему-то в ТЗ просили создать отдельные файлы не по всем разделам, поэтому перечислил эти столбцы только в общем файле
4. tmp_rfm_recency.sql - мой косяк, раньше использовал NTILE с SQL Server, там NULL-значения наоборот попадали в первую группу. Нужно было проверить, конечно
5. views.sql - в целом, согласен, но, с другой стороны, иногда лучше обезопасить себя от непреднамернной перезаписи таблицы или вьюхи

Про форточки в оконных функциях знаю, использовал раньше.
1. Почему не будет работать корректно, если убрать форточку? (ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) - потому что по умолчанию верхней границей является CURRENT ROW, соответственно last_value и будет считаться по этому значению 
2. Почему будет работать, если убрать форточку, но выбрать first_value и сортировку DESC внутри окна? А с форточкой уже нужного результата не будет - потому что с последнего значения и начнем, которое и будет CURRENT ROW

Не использовал, потому что подзапрос был простым. Да и по производительности иногда подзапрос быстрее работает, чем оконная функция)

Спасибо за комментарии!